#! /usr/bin/env python
from __future__ import division
import sys
import pathogenseq as ps
import argparse
import json

mtb_tax = "77643,1765,33892,410289,413996,561275,717522,998089,998090,998091,998092,1195237,1195465,1195466,1195467,1195468,1195469,1206780,233413,669465,1354193,1384084,1389959,1438822,1438823,1773,83331,83332,747078,757417,757418,757419,757420,757421,757422,1404322,1437856,164513,748225,748226,748227,748228,748229,748230,748231,748232,748233,748234,748235,748236,748237,748238,748239,748240,748241,748242,887710,887711,182785,336982,348776,395095,1304279,419947,443149,443150,478433,478434,478435,515615,515616,515617,520140,520141,537209,537210,555461,593245,593246,593247,593248,593249,593250,593251,593252,593253,593254,593255,593256,593257,593258,593259,593260,593261,593262,593263,593264,611302,611303,634955,652616,659019,663886,663887,668339,668340,668341,668342,668343,668344,668345,668346,668347,668348,668349,668350,675512,675513,675514,675515,675516,675517,675518,675519,675520,675521,675522,675523,687443,687444,687445,687446,687447,687448,687449,687450,687451,687452,707234,707235,707236,707237,746707,747367,747368,747369,795188,795189,795190,795191,795192,795193,795194,795195,795196,795197,795198,795199,795200,795201,795202,795203,795204,795205,795206,795207,795208,795209,795210,795211,795212,795213,795214,795215,795216,795217,795218,795219,795220,795221,795222,795223,795224,795225,795226,795227,795228,795229,795230,795231,795232,795233,795234,795235,795236,795237,795238,795239,795240,795241,795242,795243,795244,795245,795246,795247,795248,795249,795250,795251,795252,795253,795254,795255,795256,795257,795258,797301,882098,882099,882100,903511,903512,903513,903514,903515,903516,903517,903518,907895,907896,907897,907898,907899,907900,907901,907902,907903,907904,907905,907906,907907,907908,907909,907910,907911,907912,907913,907914,907915,907916,907917,907918,907919,907920,907921,907922,907923,907924,911237,937592,940668,940669,940670,993035,993036,993037,993038,993039,993040,993041,993042,993043,993044,993529,993530,993531,993532,1010834,1010835,1010836,1017054,1017055,1017056,1017057,1017058,1017059,1017060,1017061,1017062,1017063,1017064,1017065,1017066,1017067,1017068,1017069,1017070,1017071,1017072,1017073,1017074,1017075,1017076,1017077,1017078,1017079,1017080,1017081,1017082,1017083,1017084,1017085,1017086,1017087,1017088,1017089,1078763,1091499,1091500,1091501,1097669,1126682,1126683,1126684,1138877,1151113,1160714,1160715,1160716,1200347,1200348,1240677,1245275,1245787,1249615,1262525,1262526,1262529,1266446,1267355,1267356,1267357,1267358,1267359,1267360,1267361,1267362,1267363,1267364,1268062,1268063,1268064,1268065,1268634,1274414,1274415,1274416,1274417,1274418,1274419,1274420,1274421,1274422,1274423,1274424,1274425,1274426,1274427,1274428,1274429,1274430,1274431,1274432,1274433,1274434,1274435,1274436,1274437,1274438,1274439,1274440,1274441,1274442,1274443,1274444,1274445,1274446,1274447,1274448,1274449,1274450,1274451,1274452,1279011,1279039,1295717,1295718,1295719,1295720,1295721,1295722,1295723,1295724,1295725,1295726,1295727,1295728,1295729,1295730,1295731,1295732,1295733,1295734,1295735,1295736,1295737,1295738,1295739,1295740,1295741,1295742,1295743,1295744,1295745,1295746,1295747,1295748,1295749,1295750,1295751,1295752,1295753,1295754,1295755,1295756,1295757,1295758,1295759,1295760,1295761,1295762,1295763,1295764,1295765,1295766,1295767,1295768,1295769,1295770,1295771,1295772,1295773,1295774,1295775,1295776,1295777,1295778,1295779,1295780,1295781,1295782,1295783,1295784,1295785,1295786,1295787,1295788,1295789,1295790,1295791,1295792,1295793,1295794,1295795,1295796,1295797,1295798,1295799,1295800,1295801,1295802,1295803,1295804,1295805,1295806,1295807,1295808,1305848,1306400,1306410,1306411,1306412,1306413,1310114,1343499,1306414,1310115,1306415,1306416,1308865,1315977,1316940,1322343,1343498,1324218,1324219,1324220,1324221,1324222,1324223,1324224,1324225,1324226,1324227,1324228,1324229,1324230,1324231,1324232,1324233,1324234,1324235,1324236,1324237,1324238,1324239,1324240,1324241,1324242,1324243,1324244,1324245,1324246,1324247,1324248,1324249,1324250,1324251,1324252,1324253,1324254,1324255,1324256,1324257,1324258,1324259,1324260,1324262,1324263,1324264,1324265,1324266,1324267,1324268,1324270,1324271,1324272,1324273,1324274,1324275,1324276,1324277,1324278,1324279,1324280,1324281,1324282,1324283,1324284,1324285,1324286,1324287,1324288,1324289,1324290,1324291,1324292,1324293,1324294,1324295,1324296,1324297,1324298,1324299,1324300,1324301,1325585,1325586,1325587,1325588,1325589,1325590,1325591,1325592,1325593,1325594,1334047,1334048,1334049,1334050,1334051,1334052,1334053,1334054,1334055,1334056,1334057,1334058,1334059,1334060,1334061,1334062,1334063,1334064,1334065,1334066,1334067,1334068,1334069,1334070,1334071,1334072,1334073,1334074,1334075,1334076,1334077,1334078,1334079,1334080,1334081,1334082,1334083,1334084,1338505,1341711,1343500,1344043,1344044,1344045,1344046,1344047,1344048,1346765,1346766,1346767,1346768,1346769,1346770,1346771,1346772,1346773,1346774,1346775,1346776,1346777,1346778,1346779,1346780,1346781,1346782,1346783,1346784,1346785,1346786,1346787,1346788,1348776,1350393,1352570,1352571,1352572,1352573,1352574,1352575,1352576,1352577,1352578,1352579,1352580,1352581,1352582,1352583,1352584,1352585,1352586,1352587,1352588,1352589,1352590,1352591,1352592,1352593,1352594,1352595,1352596,1352597,1352598,1352599,1352600,1353527,1354101,1354102,1354103,1354105,1354106,1354107,1354108,1354109,1354110,1354111,1354112,1354113,1354114,1354115,1354116,1354117,1354118,1354119,1354120,1354121,1354122,1354123,1354124,1354125,1354126,1354127,1354128,1354129,1354130,1354131,1354132,1354133,1354134,1354135,1354136,1354137,1354138,1354139,1354140,1354142,1354143,1354144,1354145,1354146,1354147,1354148,1354149,1354150,1354151,1354152,1354153,1354154,1354155,1354156,1354157,1354158,1354159,1354160,1354165,1354182,1354192,1354276,1355018,1355019,1355020,1365185,1365190,1370123,1370124,1379257,1392648,1392649,1392650,1392651,1392652,1392653,1392654,1393752,1393753,1393754,1393755,1393756,1393757,1393758,1393759,1393760,1393761,1393762,1393763,1393764,1393765,1393766,1393767,1393768,1393769,1393770,1393771,1393772,1393773,1393774,1393775,1393776,1393777,1393778,1393779,1393780,1393781,1393782,1393783,1397853,1397854,1397855,1397856,1397857,1397858,1397859,1397860,1397861,1397862,1397863,1397864,1397865,1397866,1397867,1397868,1397869,1397870,1397871,1397872,1397873,1397874,1397875,1397876,1397877,1397878,1397879,1397880,1397881,1397882,1397883,1397884,1397885,1397886,1397887,1397888,1397889,1397890,1397891,1397892,1397893,1397894,1397895,1397896,1397897,1397898,1397899,1397900,1397901,1397902,1397903,1397904,1397905,1397906,1397907,1397908,1397909,1397910,1397911,1397912,1397913,1397914,1397915,1397916,1397917,1397918,1397919,1397920,1397921,1397922,1397923,1397924,1397925,1397926,1397927,1397928,1397929,1397930,1397931,1397932,1397933,1397934,1397935,1397936,1397937,1397938,1397939,1397940,1397941,1398477,1398478,1398479,1398480,1398481,1398482,1398483,1398484,1398485,1398486,1398487,1398488,1400870,1400871,1400872,1400873,1400874,1400875,1400876,1400877,1400878,1400879,1400880,1400881,1400882,1400883,1400884,1400885,1400886,1400887,1400888,1400889,1400890,1400891,1400892,1400893,1400894,1400895,1400896,1400897,1400898,1400899,1400900,1400901,1400902,1400903,1400904,1400905,1400906,1400907,1400908,1400909,1400910,1400911,1400912,1400913,1400914,1400915,1400916,1400917,1400918,1400919,1400920,1400921,1400922,1400923,1400924,1400925,1400926,1400927,1400928,1400929,1400930,1400931,1400932,1400933,1400934,1400935,1400936,1400937,1400938,1400939,1400940,1400941,1401813,1401814,1401815,1402164,1402165,1402166,1402167,1402168,1402169,1402170,1402171,1402172,1402173,1402174,1402175,1402176,1402177,1402178,1402179,1402180,1402181,1402182,1402183,1402184,1402185,1402186,1402187,1402188,1402189,1402190,1402473,1402474,1402475,1402476,1402477,1402478,1402479,1402480,1402481,1402482,1402483,1402484,1402583,1402584,1402585,1402586,1402587,1402588,1402589,1402590,1402591,1402592,1402593,1402594,1402595,1402596,1402597,1402598,1402599,1402600,1402601,1402602,1403022,1403023,1403024,1403025,1403026,1408904,1408905,1408906,1408907,1408908,1408909,1408910,1408911,1408912,1408913,1408914,1408915,1408916,1408917,1408918,1408919,1408920,1408921,1408922,1408923,1408924,1408925,1408926,1408927,1408928,1408929,1408930,1408931,1408932,1408933,1408934,1408935,1408936,1408937,1408938,1408939,1408940,1408941,1408942,1408943,1408944,1408945,1408946,1408947,1408948,1408949,1408950,1408951,1408952,1408953,1408954,1408955,1408956,1408957,1408958,1408959,1408960,1408961,1408962,1408963,1408964,1408965,1408966,1408967,1408968,1408969,1408970,1408971,1408972,1408973,1408974,1408975,1413001,1413002,1413003,1413004,1413005,1413006,1413007,1413008,1413009,1413010,1413011,1413012,1413013,1413014,1413015,1413016,1413017,1413018,1413019,1413020,1413021,1413022,1413023,1413024,1413025,1413026,1413027,1413028,1413029,1413030,1413031,1413032,1413033,1413034,1413035,1413036,1413037,1413038,1413039,1413040,1413041,1413042,1413043,1413044,1413045,1413046,1413047,1413048,1413049,1413050,1413051,1413052,1413053,1413054,1413055,1413056,1413057,1413058,1413059,1413060,1413061,1413062,1413063,1413064,1413065,1413066,1413067,1413068,1413069,1413070,1413071,1413072,1413073,1413074,1413075,1413076,1413077,1413078,1413079,1413080,1413081,1413082,1413083,1413084,1413085,1413086,1413087,1413088,1413089,1413090,1413091,1413092,1413093,1413094,1413095,1413096,1413097,1413098,1413099,1413100,1413101,1413102,1413103,1413104,1417005,1417008,1417009,1417010,1417011,1417012,1417013,1417014,1417015,1417016,1417017,1417018,1417019,1417020,1417021,1417022,1417023,1417024,1417025,1417026,1417027,1417028,1417029,1417030,1417031,1418250,1418251,1418252,1418253,1418254,1418255,1418256,1421917,1421918,1421919,1421920,1421921,1421922,1421923,1421924,1421925,1421926,1421927,1421928,1421929,1421930,1421931,1421932,1421933,1421934,1421935,1421936,1421937,1421938,1421939,1421940,1421941,1421942,1421943,1421944,1421945,1421946,1421947,1421948,1421949,1421950,1421951,1421952,1421953,1421954,1421955,1421956,1421957,1421958,1421959,1421960,1421961,1421962,1421963,1421964,1421965,1421966,1421967,1421968,1421969,1421970,1421971,1421972,1421973,1421974,1421975,1421976,1421977,1421978,1421979,1421980,1421981,1421982,1421983,1421984,1421985,1421986,1421987,1421988,1421989,1421990,1421991,1421992,1421993,1421994,1421995,1421996,1421997,1421998,1421999,1422000,1422001,1422002,1422003,1422004,1422005,1422006,1422007,1422008,1422009,1422010,1422011,1422012,1422013,1422014,1422015,1422016,1422017,1422018,1422019,1422020,1422021,1422022,1422023,1422024,1422025,1422026,1422027,1422028,1422029,1422030,1422031,1422032,1422033,1422034,1422035,1422036,1422037,1422038,1422039,1422040,1422041,1422042,1422043,1422044,1422045,1422046,1422047,1422048,1422049,1422050,1422051,1422052,1422053,1422054,1422055,1422056,1422057,1422058,1422059,1422060,1422061,1422062,1422063,1422064,1422065,1422066,1422067,1422068,1422069,1422070,1422071,1422072,1422073,1422074,1422075,1422076,1422077,1422078,1422079,1422080,1422081,1422082,1422083,1422084,1422085,1422086,1422087,1422088,1422089,1422090,1422091,1422092,1422093,1422094,1422095,1422096,1422097,1422098,1422099,1422100,1422101,1422102,1422103,1422104,1422105,1422106,1422107,1422108,1422109,1422110,1422111,1422112,1422113,1423425,1423426,1423427,1423428,1423429,1423430,1423431,1423432,1423433,1423434,1423435,1423436,1423437,1423438,1423439,1423440,1423441,1423442,1423443,1423444,1423445,1423446,1423447,1423448,1423449,1423450,1423451,1423452,1423453,1423454,1423455,1423456,1423457,1423458,1423459,1423460,1423461,1423462,1423463,1423464,1423465,1423466,1423467,1423468,1423469,1423470,1423471,1423472,1423473,1423474,1423475,1423476,1423477,1423478,1423479,1423480,1423481,1423482,1423483,1423484,1423485,1423486,1423487,1423488,1423489,1423490,1423491,1423492,1423493,1423494,1423495,1423496,1423497,1423498,1423499,1423500,1423501,1423502,1423503,1423504,1423505,1423506,1423507,1423508,1423509,1423510,1423511,1423512,1423513,1423514,1423515,1423516,1423517,1423518,1423519,1423520,1423521,1423522,1423523,1423524,1423525,1423526,1423527,1423528,1423529,1423530,1423531,1423532,1423533,1423534,1423535,1423536,1423537,1423538,1423539,1423540,1423541,1423542,1423543,1423544,1423545,1423546,1423547,1423548,1423549,1423550,1423551,1423552,1423553,1423554,1423555,1423556,1423557,1423558,1423559,1423560,1423561,1423562,1423563,1423564,1423565,1423566,1423567,1423568,1423569,1423570,1423571,1423572,1423573,1423574,1423575,1423576,1423577,1427177,1427178,1427179,1427180,1427181,1427182,1427183,1427184,1427185,1427186,1427187,1427188,1427189,1427190,1427191,1427192,1427193,1427194,1427195,1427196,1427197,1427198,1427199,1427200,1427201,1427202,1427203,1427204,1427205,1427206,1427207,1427208,1427209,1427210,1427211,1427212,1427213,1427214,1427215,1427216,1427217,1427218,1427219,1427220,1427221,1427222,1427223,1427224,1427225,1427226,1427227,1427228,1427229,1427230,1427231,1427232,1427233,1427234,1427235,1427236,1427237,1427238,1427239,1427240,1427241,1427242,1427243,1427244,1427245,1427246,1427247,1427248,1427249,1427250,1427251,1427252,1427253,1427254,1427255,1427256,1427257,1427258,1427259,1427260,1427261,1427262,1427263,1427264,1427265,1427266,1427267,1427268,1427269,1427270,1427271,1427272,1427273,1427274,1427275,1427276,1427277,1427278,1427279,1427280,1427281,1427282,1427283,1427284,1427285,1427286,1427287,1427288,1427289,1427290,1427291,1427292,1427293,1427294,1427295,1427297,1427298,1427299,1427300,1427301,1427302,1427303,1427304,1427305,1427306,1427307,1427308,1427309,1427310,1427311,1427312,1427313,1427314,1427315,1427316,1427317,1427318,1427319,1427320,1427321,1427322,1427323,1427324,1427325,1427326,1427327,1427328,1427329,1427330,1427516,1429886,1429887,1432058,1437452,1438824,1438825,1438826,1438827,1438828,1438829,1438832,1438833,1438834,1438835,1438836,1438837,1438838,1438839,1438840,1438841,1438842,1438843,1438844,1438845,1438846,1438847,1438848,1438849,1438850,1438851,1438852,1438853,1438854,1438855,1438856,1438857,1438858,1438859,1438860,1438861,1438862,1438863,1438864,1438865,1438866,1438867,1438868,1438869,1438870,1438871,1438872,1438873,1438874,1438875,1438876,1438877,1438878,1438879,1438880,1438881,1438882,1438883,1438884,1438885,1438886,1438887,1438888,1438889,1438890,1438891,1438892,1438893,1438894,1438895,1438896,1438897,1438898,1438899,1438900,1438901,1438902,1438903,1438904,1438905,1438906,1438907,1438908,1438909,1438910,1438911,1438912,1438913,1438914,1438915,1438916,1438917,1438918,1438919,1438920,1438921,1438922,1438923,1438924,1438925,1438926,1438927,1438928,1438929,1438930,1438931,1438932,1438933,1438934,1438935,1438936,1438937,1438938,1438939,1438940,1438941,1438942,1438943,1438944,1438945,1438946,1438947,1438948,1438949,1438950,1438951,1438952,1438953,1438954,1438955,1438956,1438957,1438958,1438959,1438960,1438961,1438962,1438963,1438964,1438965,1438966,1438967,1438968,1438969,1438970,1438971,1438972,1438973,1438974,1438975,1438976,1438977,1438978,1438979,1438980,1438981,1438982,1438983,1438984,1441925,1441926,1441927,1445606,1447264,1447265,1447266,1447267,1447268,1447269,1447270,1447271,1447272,1447273,1447274,1447275,1447276,1447277,1447278,1447279,1447280,1447281,1447282,1447283,1447284,1447285,1447286,1447287,1447288,1447289,1447290,1447291,1447292,1447293,1447294,1447295,1447296,1447297,1447298,1447299,1447300,1447301,1447302,1447303,1447304,1447305,1447306,1447307,1447308,1447309,1447310,1447311,1447312,1447313,1447314,1447315,1447316,1447317,1447318,1447319,1447320,1447321,1447322,1447323,1447324,1447325,1447326,1447327,1447328,1447329,1447330,1447331,1447332,1447333,1447334,1447335,1447336,1447337,1447338,1447339,1447340,1447341,1447342,1447343,1447344,1447345,1447346,1447347,1447348,1447349,1447350,1447351,1447352,1447353,1447354,1447355,1447356,1447357,1447358,1447359,1447360,1447361,1447362,1447363,1447364,1447365,1447366,1447367,1447368,1447369,1447370,1447371,1447372,1447373,1447374,1447375,1447376,1447377,1447378,1447379,1447380,1447381,1447382,1447383,1447384,1447385,1447386,1447387,1447388,1447389,1447390,1447391,1447392,1447393,1447394,1447395,1447396,1447397,1447398,1447399,1447400,1447401,1447402,1447403,1447404,1447405,1447406,1447407,1447408,1447409,1447410,1447411,1447412,1447413,1447414,1447415,1447416,1447417,1447418,1447419,1447420,1447421,1447422,1447423,1447424,1447425,1447426,1447427,1447428,1447429,1447430,1447431,1447432,1447433,1447434,1447435,1447436,1447437,1447438,1447439,1447440,1447441,1447442,1447443,1447444,1447445,1447446,1447447,1447448,1447449,1447450,1447451,1447452,1447453,1447454,1447455,1447456,1447457,1447458,1447459,1447460,1447461,1447462,1447463,1447464,1447465,1447466,1447467,1447468,1447469,1447470,1447471,1447472,1447473,1447474,1447475,1447476,1447477,1447478,1447479,1447480,1447481,1447482,1447483,1447484,1447485,1447486,1447487,1447488,1447489,1447490,1447491,1447492,1447493,1447494,1447495,1447496,1447497,1447498,1447499,1447500,1447501,1447502,1447503,1447504,1447505,1447506,1447507,1447508,1447509,1447510,1447511,1447512,1447513,1447514,1447515,1447516,1447517,1447518,1447519,1447520,1447521,1447522,1447523,1447524,1447525,1447526,1447527,1448390,1448391,1448392,1448393,1448394,1448395,1448396,1448397,1448398,1448399,1448400,1448401,1448402,1448403,1448404,1448405,1448406,1448407,1448408,1448409,1448410,1448411,1448412,1448413,1448414,1448415,1448416,1448417,1448418,1448419,1448420,1448421,1448422,1448423,1448424,1448425,1448426,1448427,1448428,1448429,1448430,1448431,1448432,1448433,1448434,1448435,1448436,1448437,1448438,1448439,1448440,1448441,1448442,1448443,1448444,1448445,1448446,1448447,1448448,1448449,1448450,1448451,1448452,1448453,1448454,1448455,1448456,1448457,1448458,1448459,1448460,1448461,1448462,1448463,1448464,1448465,1448466,1448467,1448468,1448469,1448470,1448471,1448472,1448473,1448474,1448475,1448476,1448477,1448478,1448479,1448480,1448481,1448482,1448483,1448484,1448485,1448486,1448487,1448488,1448489,1448490,1448491,1448492,1448493,1448494,1448495,1448496,1448497,1448498,1448499,1448500,1448501,1448502,1448503,1448504,1448505,1448506,1448507,1448508,1448509,1448510,1448511,1448512,1448513,1448514,1448515,1448516,1448517,1448518,1448519,1448520,1448521,1448522,1448523,1448524,1448525,1448526,1448527,1448528,1448529,1448530,1448531,1448532,1448533,1448534,1448535,1448536,1448537,1448538,1448539,1448540,1448541,1448542,1448543,1448544,1448545,1448546,1448547,1448548,1448549,1448550,1448551,1448552,1448553,1448554,1448555,1448556,1448557,1448558,1448559,1448560,1448561,1448562,1448563,1448564,1448565,1448566,1448567,1448568,1448569,1448570,1448571,1448572,1448573,1448574,1448575,1448576,1448577,1448578,1448579,1448580,1448581,1448582,1448583,1448584,1448585,1448586,1448587,1448588,1448589,1448590,1448591,1448592,1448593,1448594,1448595,1448596,1448597,1448598,1448599,1448600,1448601,1448602,1448603,1448604,1448605,1448606,1448607,1448608,1448609,1448610,1448611,1448612,1448613,1448614,1448615,1448616,1448617,1448618,1448619,1448620,1448621,1448622,1448623,1448624,1448625,1448626,1448627,1448628,1448629,1448630,1448631,1448632,1448633,1448634,1448635,1448636,1448637,1448638,1448639,1448640,1448641,1448642,1448643,1448644,1448645,1448646,1448647,1448648,1448649,1448650,1448651,1448652,1448653,1448654,1448655,1448656,1448657,1448658,1448659,1448660,1448661,1448662,1448663,1448664,1448665,1448666,1448667,1448668,1448669,1448670,1448671,1448672,1448673,1448674,1448675,1448676,1448677,1448678,1448679,1448680,1448681,1448682,1448683,1448684,1448685,1448686,1448687,1448688,1448689,1448690,1448691,1448692,1448693,1448694,1448695,1448696,1448697,1448698,1448699,1448700,1448701,1448702,1448703,1448704,1448705,1448706,1448707,1448708,1448709,1448710,1448711,1448712,1448713,1448714,1448715,1448716,1448717,1448718,1448719,1448720,1448721,1448722,1448723,1448724,1448725,1448726,1448727,1448728,1448729,1448730,1448731,1448732,1448733,1448734,1448735,1448736,1448737,1448738,1448739,1448740,1448741,1448742,1448743,1448744,1448745,1448746,1448747,1448748,1448749,1448750,1448751,1448752,1448753,1448754,1448755,1448756,1448757,1448758,1448759,1448760,1448761,1448762,1448763,1448764,1448765,1448766,1448767,1448768,1448769,1448770,1448771,1448772,1448773,1448774,1448775,1448776,1448777,1448778,1448779,1448780,1448781,1448782,1448783,1448784,1448785,1448786,1448787,1448788,1448789,1448790,1448791,1448792,1448793,1448794,1448795,1448796,1448797,1448798,1448799,1448800,1448801,1448802,1448803,1448804,1448805,1448806,1448807,1448808,1448809,1448810,1448811,1448812,1448813,1448814,1448815,1448816,1448817,1448818,1448819,1448820,1448821,1448822,1448823,1448824,1448825,1448826,1448827,1448828,1448829,1448830,1448831,1448832,1448833,1448834,1448835,1448836,1448837,1448838,1452723,1455078,1455079,1455080,1455081,1455082,1455083,1455084,1455085,1455086,1455087,1455088,1455089,1455090,1455091,1455092,1455093,1455094,1455095,1455096,1455097,1455098,1455099,1455100,1455101,1455102,1455103,1455104,1455105,1455106,1455107,1455108,1455109,1455110,1455111,1455112,1455113,1455114,1455115,1455116,1455117,1455118,1455119,1455120,1455121,1455122,1455123,1455124,1455125,1455126,1455127,1455128,1455129,1455130,1455131,1455132,1455133,1455134,1455135,1455136,1455137,1455138,1455139,1455140,1455141,1455142,1455143,1455144,1455145,1455146,1455147,1455148,1455149,1455150,1455151,1455152,1455153,1455154,1455155,1455156,1455157,1455158,1455159,1455160,1455161,1455162,1455163,1455164,1455165,1455166,1455167,1455168,1455169,1455170,1455171,1455172,1455173,1455174,1455175,1455176,1455177,1455178,1455179,1455180,1455181,1455182,1455183,1455184,1455185,1455186,1455187,1455188,1455189,1455190,1455191,1455192,1455193,1455194,1455195,1455196,1455197,1455198,1455199,1455200,1455201,1455202,1455203,1455204,1455205,1455206,1455207,1455208,1455209,1455210,1455211,1455212,1455213,1455214,1455215,1455216,1455217,1455218,1455219,1455220,1455221,1455222,1455223,1455224,1455225,1455226,1455227,1455228,1455229,1455230,1455231,1455232,1455233,1455234,1455236,1455237,1455238,1455240,1455241,1455242,1455244,1455245,1455246,1455248,1455249,1455250,1455252,1455253,1455254,1455256,1455257,1455258,1455259,1455260,1455261,1455262,1455263,1455264,1455265,1455266,1455267,1455268,1455269,1455270,1455271,1455272,1455273,1455274,1455275,1455276,1455277,1455278,1455279,1455280,1455281,1455282,1455283,1455284,1455285,1455286,1455287,1455288,1455289,1455290,1455291,1455292,1455293,1455294,1455295,1455296,1455297,1455298,1455299,1455300,1455301,1455302,1455303,1455304,1455305,1455306,1455307,1455308,1455309,1455310,1455311,1455312,1455313,1455314,1455611,1458472,1516074,1806,1427372,33894,572418,611304,1354104,1354141,1354161,1354162,1354163,1354164,1354166,1354167,1354168,1354169,1354170,1354171,1354172,1354173,1354174,1354175,1354176,1354177,1354178,1354179,1354180,1354181,1354183,1354184,1354185,1354186,1354187,1354188,1354189,1354190,1354191,78331,1048245,1205674,1205675,1205676,1205677,1246119,1246120,1246121,1246634,105643,115862,194542,219965,219966,219967,280783,283017,283018,283019,283020,283021,283022,392322,392323,392401,394232,394233,394234,394235,467593,933040,933041,933042,1074466,1305738,1305739,1316273,1316274,1316275,1316276,1316277,1316278,1316279,1316280,1316281,1316282,1316283,1316284,1316285,1316286,1316287,1316288,1316289,1316290,1316291,1316292,1316293,1316294,1316295,1316296,1316297,1316298,1316299,1316300,1316301,1316302,1316303,1316304,1316305,1316306,1316307,1316308,1316309,1316310,1316311,1316312,1316313,1316314,1316315,1316316,1316317,1316318,1316319,1316320,1316321,1316322,1316323,1316324,1316325,1316326,1316327,1316328,1316329,1316330,1316331,1316332,1316333,1316334,1316335,1316336,1316337,1316338,1316339,1316340,1316341,1316342,1316343,1316344,1316345,1316346,1316347,1316348,1316349,1316350,1316351,1316352,1316353,1316354,1316355,1316356,1316357,1316358,1316359,1316360,1316361,1316362,1316363,1316364,1316365,1316366,1316367,1324269,1494075,1844474,1871904,1871905,1871906,1871907"

ref = sys.argv[1]
r1 = sys.argv[2]
r2 = sys.argv[3]
prefix = sys.argv[4]
threads = sys.argv[5]

stats = {}
fastqqc = ps.qc_fastq(prefix,r1,r2,threads=threads)
stats["fastq_mean_read_len"] = fastqqc.mean_read_len
stats["fastq_read_num"] = fastqqc.read_num


fr1,fr2,tmp = fastqqc.run_centrifuge("/opt/storage2/jody/software/p+h+v",mtb_tax,threads)
stats["centrifuge_top_hit"] = tmp[0]
stats["centrifuge_pct_reads"] = tmp[1]


newfastqqc = ps.qc_fastq(prefix,fr1,fr2,threads=threads)

fastq = ps.fastq(prefix,ref,fr1,fr2,threads=threads)

fastq.illumina(mapper="minimap2")

bam_file = "%s.bam" % prefix

bam = ps.bam(bam_file,prefix,ref,threads=threads)
bam.gbcf(vtype="snps",threads=threads,call_method="low")

bamqc = bam.get_bam_qc()
cov_plot = "%s.cov.png" % (prefix)
bamqc.plot_cov("Chromosome",cov_plot)
stats["bam_pct_reads_mapped"] = bamqc.pct_reads_mapped
stats["bam_med_dp"] = bamqc.med_dp
stats["bam_depth_10"] = bamqc.genome_cov[10]
stats["bam_depth_5"] = bamqc.genome_cov[5]

json.dump(stats,open("%s.stats.json" % prefix,"w"))
O = open("%s.log"%prefix,"w")
for x in ["fastq_mean_read_len","fastq_read_num","centrifuge_top_hit","centrifuge_pct_reads","bam_pct_reads_mapped","bam_med_dp","bam_depth_5","bam_depth_10"]:
	O.write("%s\t%s\n" % (x,stats[x]))
O.close()
